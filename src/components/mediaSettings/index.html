<div class="flex flex-col gap-6">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <h2 class="text-2xl font-bold bg-gradient-to-r from-lime-300 to-lime-500 bg-clip-text text-transparent">
      Media Settings
    </h2>
    <!-- Hidden by default, we show it if it's used as a modal -->
    <button class="p-2 hover:bg-white/5 rounded-lg transition-colors hidden" data-modal-close>
      <svg class="w-6 h-6 text-slate-400 hover:text-lime-400 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>

  <!-- Main Content -->
  <div class="flex flex-col gap-6">
    <!-- Video Preview Section -->
    <div class="relative aspect-video bg-slate-900 rounded-xl overflow-hidden">
      <div class="relative w-full h-full">
        <video id="previewVideo" autoplay playsinline muted
               class="absolute inset-0 w-full h-full object-cover"></video>
        <!-- Camera Off Placeholder -->
        <div class="camera-off-placeholder hidden absolute inset-0 flex flex-col items-center justify-center 
                    bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900/50
                    [background-image:repeating-linear-gradient(45deg,transparent,transparent_2px,rgba(255,255,255,.1)_2px,rgba(255,255,255,.1)_4px)]">
          <div class="w-20 h-20 mb-4 rounded-full bg-gradient-to-br from-lime-500/20 to-lime-400/20 
                      border border-lime-400/10 flex items-center justify-center">
            <svg class="w-10 h-10 text-lime-400/60" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" 
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
          </div>
          <p class="text-sm text-lime-400/60">Camera is turned off</p>
        </div>
      </div>
    </div>

    <!-- Settings Controls -->
    <div class="space-y-6">
      <!-- Camera Settings -->
      <div class="space-y-2">
        <label class="block text-sm font-medium text-lime-300">Camera</label>
        <div class="flex gap-2 sm:flex-row flex-col">
          <div class="flex-1 min-w-0">
            <select id="cameraSelect" 
                    class="w-full px-4 py-2.5 bg-slate-800/50 border border-lime-400/10 rounded-xl 
                           focus:outline-none focus:ring-2 focus:ring-lime-400/50 focus:border-lime-400/30
                           text-white text-sm truncate">
              <option value="">Loading cameras...</option>
            </select>
          </div>
          <button id="toggleCamera" 
                  class="p-2.5 rounded-xl transition-all duration-200 bg-white/5 hover:bg-white/10 text-white
                         data-[active=false]:bg-red-500/20 data-[active=false]:text-red-500
                         sm:w-auto w-full"
                  data-active="true">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Microphone Settings -->
      <div class="space-y-2">
        <label class="block text-sm font-medium text-lime-300">Microphone</label>
        <div class="flex gap-2 sm:flex-row flex-col">
          <div class="flex-1 min-w-0">
            <select id="micSelect" 
                    class="w-full px-4 py-2.5 bg-slate-800/50 border border-lime-400/10 rounded-xl 
                           focus:outline-none focus:ring-2 focus:ring-lime-400/50 focus:border-lime-400/30
                           text-white text-sm truncate">
              <option value="">Loading microphones...</option>
            </select>
          </div>
          <button id="toggleMic" 
                  class="p-2.5 rounded-xl transition-all duration-200 bg-white/5 hover:bg-white/10 text-white
                         data-[active=false]:bg-red-500/20 data-[active=false]:text-red-500
                         sm:w-auto w-full"
                  data-active="true">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
            </svg>
          </button>
        </div>
        <!-- Audio Level Meter -->
        <div class="mt-2">
          <div class="relative h-1.5 bg-slate-700/50 rounded-full overflow-hidden">
            <!-- Background segments for level indication -->
            <div class="absolute inset-0 flex">
              <div class="flex-1 border-r border-slate-700"></div>
              <div class="w-[30%] border-r border-slate-700"></div>
              <div class="w-[20%]"></div>
            </div>
            <!-- Meter fill with gradient -->
            <div class="meter-fill h-full rounded-full transition-all duration-100
                        bg-gradient-to-r from-slate-400 via-lime-400 to-red-500" 
                 style="width: 0%"></div>
          </div>
          <!-- Level indicator text -->
          <div class="flex justify-between mt-1 text-[10px] text-slate-400">
            <span>Too quiet</span>
            <span>Good</span>
            <span>Too loud</span>
          </div>
        </div>
      </div>

      <!-- Speaker Settings -->
      <div class="space-y-2">
        <label class="block text-sm font-medium text-lime-300">Speaker</label>
        <div class="flex gap-2 sm:flex-row flex-col">
          <div class="flex-1 min-w-0">
            <select id="speakerSelect" 
                    class="w-full px-4 py-2.5 bg-slate-800/50 border border-lime-400/10 rounded-xl 
                           focus:outline-none focus:ring-2 focus:ring-lime-400/50 focus:border-lime-400/30
                           text-white text-sm truncate">
              <option value="">Loading speakers...</option>
            </select>
          </div>
          <div class="flex gap-2">
            <button id="testAudio" 
                    class="p-2.5 rounded-xl transition-all duration-200 bg-white/5 hover:bg-white/10 text-white
                           sm:w-auto w-full group relative"
                    data-testing="false">
              <!-- Speaker icon -->
              <svg class="w-5 h-5 transition-opacity duration-200" 
                   fill="none" 
                   viewBox="0 0 24 24" 
                   stroke="currentColor"
                   data-test-icon>
                <path stroke-linecap="round" 
                      stroke-linejoin="round" 
                      stroke-width="2"
                      d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
              </svg>
              <!-- Loading spinner -->
              <svg class="absolute inset-0 m-auto w-5 h-5 animate-spin transition-opacity duration-200 opacity-0" 
                   data-test-spinner
                   viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              <span class="absolute left-1/2 -translate-x-1/2 -top-8 px-2 py-1 bg-black/90 text-xs rounded 
                           opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                Test Speaker
              </span>
            </button>
            <button id="toggleLoopback" 
                    class="p-2.5 rounded-xl transition-all duration-200 
                           bg-white/5 hover:bg-white/10 text-white
                           data-[active=true]:bg-lime-500/20 data-[active=true]:text-lime-500
                           data-[active=true]:hover:bg-lime-500/30 data-[active=true]:hover:text-lime-500
                           sm:w-auto w-full group relative"
                    data-active="false">
              <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                      d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"/>
              </svg>
              <span class="absolute left-1/2 -translate-x-1/2 -top-8 px-2 py-1 bg-black/90 text-xs rounded 
                           opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                Audio Loopback
              </span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer Actions -->
  <div class="flex justify-end">
    <button id="saveSettings" 
            class="px-6 py-3 bg-lime-500 hover:bg-lime-600 text-white font-medium rounded-xl
                   transform transition-all duration-300 hover:scale-[1.02] 
                   hover:shadow-lg hover:shadow-lime-500/25 active:scale-[0.98]">
      Save Settings
    </button>
  </div>
  <script type="module">
    import { MediaSettings } from '../../js/ui/components/mediaSettings/index.js';
  </script>
</div> 